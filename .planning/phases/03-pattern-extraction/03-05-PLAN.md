---
phase: 03-pattern-extraction
plan: 05
type: execute
wave: 2
depends_on: [03-01, 03-02, 03-03]
files_modified:
  - .knowledge/extractor/case-study.ts
autonomous: true

must_haves:
  truths:
    - "Case study Markdown includes site overview and design rationale"
    - "Extracted patterns are documented with usage context"
    - "Screenshots or visual descriptions enhance documentation"
    - "Case study references source URL and extraction date"
  artifacts:
    - path: ".knowledge/extractor/case-study.ts"
      provides: "Case study documentation generator"
      exports: ["generateCaseStudy", "formatPatternSection", "generateDesignRationale"]
  key_links:
    - from: ".knowledge/extractor/case-study.ts"
      to: ".knowledge/extractor/pattern-identifier.ts"
      via: "pattern data"
      pattern: "ExtractionData|Pattern"
---

<objective>
Create case study documentation generator for extracted patterns.

Purpose: Generate Markdown documentation that explains the design context, rationale, and usage of extracted patterns.
Output: Case study generator that produces comprehensive pattern documentation.
</objective>

<execution_context>
@/Users/khairul/.claude/get-shit-done/workflows/execute-plan.md
@/Users/khairul/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-pattern-extraction/03-RESEARCH.md
@.knowledge/schema/pattern.schema.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create case study generator module</name>
  <files>.knowledge/extractor/case-study.ts</files>
  <action>
Create `.knowledge/extractor/case-study.ts` with:

1. Import types:
```typescript
import type { Pattern } from '../schema/pattern.schema';
import type { ExtractionData } from './pattern-identifier';
import type { StructureAnalysis } from './dom-analyzer';
```

2. `CaseStudyMetadata` type:
```typescript
interface CaseStudyMetadata {
  url: string;
  siteName: string;
  extractedAt: string;
  patternCount: number;
  categories: string[];
}
```

3. `generateSiteOverview(data: ExtractionData)` function:
   - Extract site name from URL or title
   - Summarize page structure (has header, nav, etc.)
   - List key design characteristics observed
   - Return formatted Markdown section

4. `formatPatternSection(pattern: Pattern)` function:
   - Format pattern name and category as header
   - List design principles as bullet points
   - Include code example if available
   - Add accessibility notes if present
   - Return formatted Markdown section

5. `generateDesignRationale(patterns: Pattern[], structure: StructureAnalysis)` function:
   - Analyze why certain patterns were used
   - Connect patterns to common design goals (UX, accessibility, performance)
   - Suggest when to use these patterns
   - Return formatted Markdown section

6. `generateCaseStudy(data: ExtractionData, patterns: Pattern[])` function:
   - Assemble complete case study document:
     - Title and metadata (URL, date)
     - Site overview section
     - Design rationale section
     - Individual pattern sections
     - Summary and recommendations
   - Return complete Markdown string

Template structure:
```markdown
# Case Study: {Site Name}

**Source:** {url}
**Analyzed:** {date}
**Patterns Found:** {count}

## Overview

{site overview}

## Design Rationale

{rationale}

## Patterns Extracted

### {Pattern 1 Name}

{pattern section}

### {Pattern 2 Name}

{pattern section}

## Summary

{recommendations for using these patterns}
```
  </action>
  <verify>
Run TypeScript compiler: `npx tsc --noEmit .knowledge/extractor/case-study.ts`
No type errors.
  </verify>
  <done>Case study module exists with generateCaseStudy, formatPatternSection, generateDesignRationale functions</done>
</task>

<task type="auto">
  <name>Task 2: Test case study generation with mock data</name>
  <files>.knowledge/extractor/case-study.ts</files>
  <action>
Add a test/validation function at the end of case-study.ts:

```typescript
// Validation - run with: npx tsx .knowledge/extractor/case-study.ts
if (require.main === module) {
  const mockPattern: Pattern = {
    name: 'Hero Section Layout',
    category: 'layout',
    tags: ['hero', 'landing', 'responsive'],
    frameworks: ['react', 'vue', 'svelte', 'vanilla'],
    principles: [
      'Full viewport height for impactful first impression',
      'Centered content with max-width constraint',
      'Clear CTA button hierarchy'
    ],
    accessibility: {
      notes: 'Ensure sufficient color contrast on overlay text',
      wcag_level: 'AA'
    }
  };

  const mockData: Partial<ExtractionData> = {
    url: 'https://example.com',
    timestamp: new Date().toISOString(),
    domHierarchy: {
      structure: {
        hasHeader: true,
        hasNav: true,
        hasMain: true,
        hasFooter: true,
        hasSidebar: false,
        formCount: 1,
        buttonCount: 3,
        linkCount: 10
      }
    } as any
  };

  const caseStudy = generateCaseStudy(mockData as ExtractionData, [mockPattern]);
  console.log(caseStudy);
}
```

Run the validation and verify:
- Case study has proper Markdown structure
- Metadata section includes URL and date
- Pattern sections are well-formatted
- Design rationale provides useful context
  </action>
  <verify>
Run: `npx tsx .knowledge/extractor/case-study.ts`
Should output a complete, well-formatted Markdown case study document.
  </verify>
  <done>Case study generator produces properly structured Markdown documentation</done>
</task>

</tasks>

<verification>
1. `.knowledge/extractor/case-study.ts` exists with all functions
2. TypeScript compiles without errors
3. Generated Markdown follows expected template structure
4. Pattern sections include all relevant information
5. Design rationale provides meaningful context
</verification>

<success_criteria>
- Case study includes site metadata (URL, date, pattern count)
- Site overview summarizes page structure
- Each pattern is documented with principles and code examples
- Design rationale explains pattern usage context
- Output is valid, readable Markdown
</success_criteria>

<output>
After completion, create `.planning/phases/03-pattern-extraction/03-05-SUMMARY.md`
</output>

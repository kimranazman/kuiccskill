---
phase: 04-multi-framework-docs
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .knowledge/schema/pattern.schema.ts
  - .knowledge/schema/categories.ts
autonomous: true

must_haves:
  truths:
    - "Pattern schema accepts documentation fields (description, usage, parameters)"
    - "Pattern schema accepts framework_compatibility with version strings"
    - "Existing patterns still validate after schema changes (backward compatible)"
  artifacts:
    - path: ".knowledge/schema/pattern.schema.ts"
      provides: "Extended schema with documentation and compatibility fields"
      exports: ["PatternSchema", "Pattern", "PatternInput"]
  key_links:
    - from: ".knowledge/schema/pattern.schema.ts"
      to: "zod"
      via: "z.object"
      pattern: "z\\.object"
---

<objective>
Extend pattern schema with documentation and framework compatibility fields.

Purpose: Enable patterns to include comprehensive documentation (description, usage, parameters, best practices) and track framework version compatibility (React 18+, Vue 3+, etc.).
Output: Updated Zod schema that validates new fields while remaining backward compatible with existing patterns.
</objective>

<execution_context>
@/Users/khairul/.claude/get-shit-done/workflows/execute-plan.md
@/Users/khairul/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-multi-framework-docs/04-RESEARCH.md
@.knowledge/schema/pattern.schema.ts
@.knowledge/schema/categories.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add documentation schema fields</name>
  <files>.knowledge/schema/pattern.schema.ts</files>
  <action>
Add new schema sections to pattern.schema.ts:

1. Create ParameterSchema for documenting pattern parameters:
```typescript
const ParameterSchema = z.object({
  name: z.string(),
  type: z.string(),
  description: z.string(),
  required: z.boolean().default(true),
  default: z.string().optional(),
});
```

2. Create DocumentationSchema for pattern docs:
```typescript
const DocumentationSchema = z.object({
  description: z.string().min(10).max(500),
  usage: z.string().optional(),
  parameters: z.array(ParameterSchema).optional(),
  best_practices: z.array(z.string()).optional(),
  related_patterns: z.array(z.string()).optional(),
});
```

3. Add documentation field to PatternSchema as optional (backward compatible):
```typescript
documentation: DocumentationSchema.optional(),
```

4. Export DocumentationSchema and ParameterSchema types.
  </action>
  <verify>
Run TypeScript compiler: `npx tsc --noEmit .knowledge/schema/pattern.schema.ts`
No type errors.
  </verify>
  <done>DocumentationSchema and ParameterSchema added to pattern.schema.ts with proper types exported</done>
</task>

<task type="auto">
  <name>Task 2: Add framework compatibility schema</name>
  <files>.knowledge/schema/pattern.schema.ts</files>
  <action>
Add framework compatibility schema to pattern.schema.ts:

1. Create FrameworkCompatibilitySchema:
```typescript
const FrameworkCompatibilitySchema = z.object({
  react: z.string().optional(),    // e.g., "18.0+"
  vue: z.string().optional(),      // e.g., "3.0+"
  svelte: z.string().optional(),   // e.g., "4.0+"
  vanilla: z.boolean().optional(), // true = supported
});
```

2. Add to PatternSchema as optional field:
```typescript
framework_compatibility: FrameworkCompatibilitySchema.optional(),
```

3. Export FrameworkCompatibilitySchema type.
  </action>
  <verify>
Run TypeScript compiler: `npx tsc --noEmit .knowledge/schema/pattern.schema.ts`
No type errors.
  </verify>
  <done>FrameworkCompatibilitySchema added with version string support for each framework</done>
</task>

<task type="auto">
  <name>Task 3: Validate backward compatibility</name>
  <files>.knowledge/schema/pattern.schema.ts, .knowledge/patterns/layout/css-grid-system.yaml</files>
  <action>
Create a simple validation test to ensure existing patterns still validate:

1. Create a test script at .knowledge/schema/validate-patterns.ts:
```typescript
import { PatternSchema } from './pattern.schema';
import { readFileSync } from 'fs';
import { parse } from 'yaml';
import { glob } from 'glob';

async function validatePatterns() {
  const patterns = await glob('.knowledge/patterns/**/*.yaml');
  let valid = 0;
  let invalid = 0;

  for (const file of patterns) {
    const content = readFileSync(file, 'utf-8');
    const data = parse(content);
    const result = PatternSchema.safeParse(data);
    if (result.success) {
      valid++;
    } else {
      console.error(`Invalid: ${file}`, result.error.issues);
      invalid++;
    }
  }

  console.log(`Validated ${valid} patterns, ${invalid} invalid`);
  process.exit(invalid > 0 ? 1 : 0);
}

validatePatterns();
```

2. Run validation: `npx tsx .knowledge/schema/validate-patterns.ts`
3. All 14 existing patterns should validate successfully.
  </action>
  <verify>
Run: `npx tsx .knowledge/schema/validate-patterns.ts`
Output shows "Validated 14 patterns, 0 invalid"
  </verify>
  <done>All existing patterns validate against extended schema (backward compatibility confirmed)</done>
</task>

</tasks>

<verification>
- [ ] TypeScript compilation passes for schema files
- [ ] All 14 existing patterns still validate
- [ ] New optional fields don't break pattern validation
- [ ] Types properly exported for downstream use
</verification>

<success_criteria>
Schema extended with:
- DocumentationSchema (description, usage, parameters, best_practices, related_patterns)
- FrameworkCompatibilitySchema (react, vue, svelte, vanilla version strings)
All existing patterns validate without modification (backward compatible).
</success_criteria>

<output>
After completion, create `.planning/phases/04-multi-framework-docs/04-01-SUMMARY.md`
</output>

name: Dark Mode Theme Toggle
category: micro-interactions
tags:
  - theme
  - dark-mode
  - toggle
  - switch
  - accessibility
source:
  url: https://opalcamera.com
  extracted: 2026-02-02
principles:
  - Store preference in localStorage for persistence
  - Respect system preference via prefers-color-scheme
  - Use CSS custom properties for theme values
  - Apply theme class to document root for global effect
  - Animate transitions smoothly but respect reduced motion
accessibility:
  level: AA
  notes: Include proper aria-label, support keyboard activation, announce state changes
frameworks:
  - react
  - vue
  - svelte
  - vanilla
documentation:
  description: A toggle button that switches between light and dark color themes, with system preference detection and persistent storage.
  usage: Place in header or settings area to allow users to switch between light and dark modes.
  parameters:
    - name: defaultTheme
      type: string
      default: "system"
      description: Initial theme (light, dark, or system)
    - name: storageKey
      type: string
      default: "theme"
      description: localStorage key for persistence
  best_practices:
    - Always respect system preference initially
    - Persist user choice across sessions
    - Use CSS custom properties for easy theming
    - Provide smooth but not distracting transition
framework_compatibility:
  react: "18+"
  vue: "3+"
  svelte: "4+"
  vanilla: true
code_examples:
  react: |
    import { useState, useEffect } from 'react';
    import styles from './ThemeToggle.module.css';

    type Theme = 'light' | 'dark';

    interface ThemeToggleProps {
      storageKey?: string;
    }

    export function ThemeToggle({ storageKey = 'theme' }: ThemeToggleProps) {
      const [theme, setTheme] = useState<Theme>('light');

      useEffect(() => {
        // Check stored preference or system preference
        const stored = localStorage.getItem(storageKey) as Theme | null;
        const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const initial = stored || (systemDark ? 'dark' : 'light');

        setTheme(initial);
        document.documentElement.classList.toggle('dark', initial === 'dark');
      }, [storageKey]);

      const toggle = () => {
        const newTheme = theme === 'light' ? 'dark' : 'light';
        setTheme(newTheme);
        localStorage.setItem(storageKey, newTheme);
        document.documentElement.classList.toggle('dark', newTheme === 'dark');
      };

      return (
        <button
          className={styles.toggle}
          onClick={toggle}
          aria-label={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}
          title={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}
        >
          <span className={`${styles.icon} ${styles.sun}`} aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
              <circle cx="12" cy="12" r="5"/>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
          </span>
          <span className={`${styles.icon} ${styles.moon}`} aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
              <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
            </svg>
          </span>
        </button>
      );
    }

    // ThemeToggle.module.css
    // .toggle {
    //   position: relative;
    //   width: 40px;
    //   height: 40px;
    //   border: none;
    //   background: transparent;
    //   cursor: pointer;
    //   border-radius: 8px;
    // }
    // .toggle:hover { background: rgba(0, 0, 0, 0.05); }
    // :global(.dark) .toggle:hover { background: rgba(255, 255, 255, 0.1); }
    // .icon {
    //   position: absolute;
    //   inset: 8px;
    //   transition: opacity 0.2s, transform 0.2s;
    // }
    // .sun { opacity: 1; transform: rotate(0); }
    // .moon { opacity: 0; transform: rotate(-90deg); }
    // :global(.dark) .sun { opacity: 0; transform: rotate(90deg); }
    // :global(.dark) .moon { opacity: 1; transform: rotate(0); }
  vue: |
    <template>
      <button
        class="theme-toggle"
        @click="toggle"
        :aria-label="`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`"
      >
        <span class="icon sun" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
        </span>
        <span class="icon moon" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
          </svg>
        </span>
      </button>
    </template>

    <script setup lang="ts">
    import { ref, onMounted } from 'vue';

    const props = withDefaults(defineProps<{ storageKey?: string }>(), {
      storageKey: 'theme'
    });

    const theme = ref<'light' | 'dark'>('light');

    onMounted(() => {
      const stored = localStorage.getItem(props.storageKey) as 'light' | 'dark' | null;
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      theme.value = stored || (systemDark ? 'dark' : 'light');
      document.documentElement.classList.toggle('dark', theme.value === 'dark');
    });

    const toggle = () => {
      theme.value = theme.value === 'light' ? 'dark' : 'light';
      localStorage.setItem(props.storageKey, theme.value);
      document.documentElement.classList.toggle('dark', theme.value === 'dark');
    };
    </script>

    <style scoped>
    .theme-toggle {
      position: relative;
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      cursor: pointer;
      border-radius: 8px;
    }
    .theme-toggle:hover { background: rgba(0, 0, 0, 0.05); }
    :global(.dark) .theme-toggle:hover { background: rgba(255, 255, 255, 0.1); }
    .icon {
      position: absolute;
      inset: 8px;
      transition: opacity 0.2s, transform 0.2s;
    }
    .sun { opacity: 1; transform: rotate(0); }
    .moon { opacity: 0; transform: rotate(-90deg); }
    :global(.dark) .sun { opacity: 0; transform: rotate(90deg); }
    :global(.dark) .moon { opacity: 1; transform: rotate(0); }
    </style>
  svelte: |
    <script lang="ts">
      import { onMount } from 'svelte';

      export let storageKey = 'theme';

      let theme: 'light' | 'dark' = 'light';

      onMount(() => {
        const stored = localStorage.getItem(storageKey) as 'light' | 'dark' | null;
        const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        theme = stored || (systemDark ? 'dark' : 'light');
        document.documentElement.classList.toggle('dark', theme === 'dark');
      });

      function toggle() {
        theme = theme === 'light' ? 'dark' : 'light';
        localStorage.setItem(storageKey, theme);
        document.documentElement.classList.toggle('dark', theme === 'dark');
      }
    </script>

    <button
      class="theme-toggle"
      on:click={toggle}
      aria-label={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}
    >
      <span class="icon sun" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
      </span>
      <span class="icon moon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
        </svg>
      </span>
    </button>

    <style>
      .theme-toggle {
        position: relative;
        width: 40px;
        height: 40px;
        border: none;
        background: transparent;
        cursor: pointer;
        border-radius: 8px;
      }
      .theme-toggle:hover { background: rgba(0, 0, 0, 0.05); }
      :global(.dark) .theme-toggle:hover { background: rgba(255, 255, 255, 0.1); }
      .icon {
        position: absolute;
        inset: 8px;
        transition: opacity 0.2s, transform 0.2s;
      }
      .sun { opacity: 1; transform: rotate(0); }
      .moon { opacity: 0; transform: rotate(-90deg); }
      :global(.dark) .sun { opacity: 0; transform: rotate(90deg); }
      :global(.dark) .moon { opacity: 1; transform: rotate(0); }
    </style>
  vanilla: |
    /* HTML */
    <button class="theme-toggle" aria-label="Switch to dark mode" data-theme-toggle>
      <span class="theme-toggle__sun" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
      </span>
      <span class="theme-toggle__moon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
        </svg>
      </span>
    </button>

    /* CSS */
    :root {
      --bg: #ffffff;
      --text: #000000;
    }

    .dark {
      --bg: #1a1a1a;
      --text: #ffffff;
    }

    body {
      background: var(--bg);
      color: var(--text);
      transition: background 0.3s, color 0.3s;
    }

    .theme-toggle {
      position: relative;
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      cursor: pointer;
      border-radius: 8px;
    }

    .theme-toggle:hover {
      background: rgba(128, 128, 128, 0.1);
    }

    .theme-toggle__sun,
    .theme-toggle__moon {
      position: absolute;
      inset: 8px;
      transition: opacity 0.2s, transform 0.2s;
    }

    .theme-toggle__sun {
      opacity: 1;
      transform: rotate(0);
    }

    .theme-toggle__moon {
      opacity: 0;
      transform: rotate(-90deg);
    }

    .dark .theme-toggle__sun {
      opacity: 0;
      transform: rotate(90deg);
    }

    .dark .theme-toggle__moon {
      opacity: 1;
      transform: rotate(0);
    }

    /* JavaScript */
    function initThemeToggle(storageKey = 'theme') {
      const toggle = document.querySelector('[data-theme-toggle]');
      if (!toggle) return;

      // Get initial theme
      const stored = localStorage.getItem(storageKey);
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      let theme = stored || (systemDark ? 'dark' : 'light');

      // Apply initial theme
      document.documentElement.classList.toggle('dark', theme === 'dark');
      updateLabel();

      // Toggle handler
      toggle.addEventListener('click', () => {
        theme = theme === 'light' ? 'dark' : 'light';
        document.documentElement.classList.toggle('dark', theme === 'dark');
        localStorage.setItem(storageKey, theme);
        updateLabel();
      });

      function updateLabel() {
        toggle.setAttribute('aria-label', `Switch to ${theme === 'light' ? 'dark' : 'light'} mode`);
      }
    }

    document.addEventListener('DOMContentLoaded', initThemeToggle);
